}
#Posterior distribution of relevant model parameters
parameters_credible_intervals(piecewise)
plot(piecewisemodel)
plot(piecewisemodel)
plot(piecewise)
#fit the model constant model
piecewisemodel = FOImodel(type = 'piecewise', priorC1 = 0.6, priorC2 = 1, seroreversion = 1, priorRho1 = 0.06, priorRho2 = 0, K=2, se = 0.93, sp=0.902)
#fit the model constant model
piecewisemodel = FOImodel(type = 'piecewise', priorC1 = 0.6, priorC2 = 1, seroreversion = 1, priorRho1 = 0.06, priorRho2 = 0, K=2, se = 0.93, sp=0.902)
asembopiecewise = fit(data = asembo_chik,  model = piecewisemodel, chains=1, iter=5000)
seroprevalence.fit(asembopiecewise, YLIM = 1, age_class = 5)
#Plotting the posterior distributions
plot_posterior(piecewise)
plot <- function(FOIfit,
mean_only = FALSE,
individual_samples = 0,
YLIM = 1,
XLIM1 = NULL,
XLIM2 = NULL,
...) {
chains <- rstan::extract(FOIfit$fit)
L1 <- chains$lambda
plots <- list()
index.plot <- 0
for (cat in FOIfit$data$unique.categories) {
index.plot <- index.plot + 1
w <- which(FOIfit$data$category == cat, arr.ind = TRUE)[, 1]
d <- FOIfit$data$categoryindex[w]
p1 <- proportions.index(d)
M <- dim(chains$P)[1]
L <- matrix(0, nrow = M, ncol = FOIfit$data$A)
# Weighted FOI for each subcategory
for (i in seq_along(p1$index)) {
L <- L + p1$prop[i] * chains$Flambda[, p1$index[i]] * L1
}
# Compute posterior mean and 95% credible interval per year
par_out <- apply(L, 2, function(x)
c(mean = mean(x), quantile(x, probs = c(0.025, 0.975))))
latest_sampling_year <- max(FOIfit$data$sampling_year)
# Ascending order: earliest â†’ latest
yrs <- seq(latest_sampling_year - FOIfit$data$A + 1, latest_sampling_year)
par_out <- par_out[, seq_len(length(yrs))]
par_out[which(par_out > YLIM)] <- YLIM
meanData <- data.frame(x = yrs, y = par_out["mean", ])
# Initialize ggplot
p <- ggplot2::ggplot()
# Add 95% credible interval shading
if (!mean_only) {
xpoly <- c(yrs, rev(yrs))
ypoly <- c(par_out["2.5%", ], rev(par_out["97.5%", ]))
DataEnvelope <- data.frame(x = xpoly, y = ypoly)
p <- p + ggplot2::geom_polygon(
data = DataEnvelope,
ggplot2::aes(x, y),
fill = "#d7def3",
alpha = 0.9
)
}
# Add individual posterior samples
if (individual_samples > 0) {
Index_samples <- sample(nrow(L), individual_samples)
for (i in Index_samples) {
ind_foi <- data.frame(x = yrs, y = L[i, ])
p <- p + ggplot2::geom_line(
data = ind_foi,
ggplot2::aes(x = x, y = y),
size = 0.8,
colour = "#bbbbbb",
alpha = 0.6
)
}
}
# Final plot assembly
if (is.null(XLIM1)) XLIM1 <- min(yrs)
if (is.null(XLIM2)) XLIM2 <- max(yrs)
p <- p +
ggplot2::geom_line(
data = meanData,
ggplot2::aes(x = x, y = y),
size = 1.1,
color = "#5e6b91"
) +
ggplot2::theme_classic() +
ggplot2::theme(
axis.text.x = ggplot2::element_text(size = 22),
axis.text.y = ggplot2::element_text(size = 22),
text = ggplot2::element_text(size = 16)
) +
ggplot2::xlab("Year") +
ggplot2::ylab("Force of infection") +
ggplot2::ylim(0, YLIM) +
ggplot2::xlim(XLIM1, XLIM2)
plots[[index.plot]] <- p
plots[[index.plot]]$category <- cat
}
return(plots)
}
#Posterior distribution of relevant model parameters
parameters_credible_intervals(piecewise)
plot(asembopiecewise)
plot(asembopiecewise)
library(haven)
library(dplyr)
library(arsenal)
library(Rsero)
library(readxl)
library(rstan)
# Robust data loader: update data_dir to where your .dta files live (or use here::here("..."))
data_dir <- "/Users/augustinemasinde/Desktop/PhD files/Global Health"  # <- update if needed
data_files <- list(
Asembodata = file.path(data_dir, "Asembo PBIDS arbo.dta"),
Kilifidata = file.path(data_dir, "KHDSS arbo.dta"),
Kiberadata = file.path(data_dir, "Kibera PBIDS arbo.dta"),
manyattadata = file.path(data_dir, "Manyatta HDSS arbo.dta"),
NairobiUrbandata = file.path(data_dir, "NUHDSS arbo.dta")
)
#Asembo
asembodata<- Asembodata %>%
select(ageyrs,sex,age_cat,CHKpos, DENpos, RVFpos)
asembodata$RVFpos <- ifelse(asembodata$RVFpos == 1, TRUE, FALSE)
asembodata$DENpos <- ifelse(asembodata$DENpos == 1, TRUE, FALSE)
asembodata$CHKpos <- ifelse(asembodata$CHKpos == 1, TRUE, FALSE)
asembodata$ageyrs=  as.integer(asembodata$ageyrs)
asembodata <- asembodata %>%
mutate(ageyrs = ifelse(ageyrs == 0, 1, ageyrs))
asembodata$sex<-as.character(asembodata$sex)
asembo_chik <-SeroData(age_at_sampling = asembodata$ageyrs,
Y= asembodata$CHKpos,
sampling_year = 2022)
seroprevalence(asembo_chik)
seroprevalence.plot(asembo_chik, age_class = 5)
seroprevalence.plot(asembo_chik, age_class = 1)
seroprevalence.plot(asembo_chik, age_class = 5)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.3, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 5, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.3, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = fit(data = asembo_chik,  model = piecewisemodel, chains=1, iter=5000)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.2, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = fit(data = asembo_chik,  model = piecewisemodel, chains=1, iter=5000)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
plot(piecewisemodel, YLIM =1)
plot_posterior(piecewisemodel)
parameters_credible_intervals(piecewisemodel)
1/0.1534103
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.1, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = fit(data = asembo_chik,  model = piecewisemodel, chains=1, iter=5000)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
plot(piecewisemodel, YLIM =1)
plot_posterior(piecewisemodel)
parameters_credible_intervals(piecewisemodel)
1/0.1414365
#manyatta
manyattadata<- manyattadata_clean %>%
select(ageyrs,sex,age_cat,CHKpos, DENpos, RVFpos)
manyattadata$RVFpos <- ifelse(manyattadata$RVFpos == 1, TRUE, FALSE)
manyattadata$DENpos <- ifelse(manyattadata$DENpos == 1, TRUE, FALSE)
manyattadata$CHKpos <- ifelse(manyattadata$CHKpos == 1, TRUE, FALSE)
manyattadata$ageyrs=  as.integer(manyattadata$ageyrs)
manyattadata <- manyattadata %>%
mutate(ageyrs = ifelse(ageyrs == 0, 1, ageyrs))
manyattadata$sex<-as.character(manyattadata$sex)
manyatta_chik <-SeroData(age_at_sampling = manyattadata$ageyrs,
Y= manyattadata$CHKpos,
sampling_year = 2022)
seroprevalence(manyatta_chik)
seroprevalence.plot(manyatta_chik, age_class = 5)
#fit the model constant model
manyattapiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
print(manyattapiecewisemodel)
manyattapiecewisemodel = fit(data = manyatta_chik,  model = manyattapiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
plot_posterior(manyattapiecewisemodel)
traceplot_Rsero(manyattapiecewisemodel)
plot(manyattapiecewisemodel, YLIM =1)
parameters_credible_intervals(manyattapiecewisemodel)
1/0.03014285
#fit the model constant model
manyattapiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.01, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
print(manyattapiecewisemodel)
manyattapiecewisemodel = fit(data = manyatta_chik,  model = manyattapiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
plot_posterior(manyattapiecewisemodel)
traceplot_Rsero(manyattapiecewisemodel)
plot(manyattapiecewisemodel, YLIM =1)
parameters_credible_intervals(manyattapiecewisemodel)
1/0.02952756
#fit the model constant model
manyattapiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
print(manyattapiecewisemodel)
manyattapiecewisemodel = fit(data = manyatta_chik,  model = manyattapiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
plot_posterior(manyattapiecewisemodel)
traceplot_Rsero(manyattapiecewisemodel)
plot(manyattapiecewisemodel, YLIM =1)
parameters_credible_intervals(manyattapiecewisemodel)
#kilifi
kilifidata<- Kilifidata_clean %>%
select(ageyrs,sex,age_cat,CHKpos, DENpos, RVFpos)
kilifidata$RVFpos <- ifelse(kilifidata$RVFpos == 1, TRUE, FALSE)
kilifidata$DENpos <- ifelse(kilifidata$DENpos == 1, TRUE, FALSE)
kilifidata$CHKpos <- ifelse(kilifidata$CHKpos == 1, TRUE, FALSE)
kilifidata$ageyrs=  as.integer(kilifidata$ageyrs)
kilifidata <- kilifidata %>%
mutate(ageyrs = ifelse(ageyrs == 0, 1, ageyrs))
kilifidata$sex<-as.character(kilifidata$sex)
kilifidata_chik <-SeroData(age_at_sampling = kilifidata$ageyrs,
Y= kilifidata$RVFpos,
sampling_year = 2022)
seroprevalence(kilifidata_chik)
seroprevalence.plot(kilifidata_chik, age_class = 5)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.4, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.2, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = fit(data = asembo_chik,  model = piecewisemodel, chains=1, iter=5000)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
plot(piecewisemodel, YLIM =1)
plot(piecewisemodel, YLIM =2)
plot_posterior(piecewisemodel)
parameters_credible_intervals(piecewisemodel)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
ggsave("asembo.chik.sero.png")
plot(piecewisemodel, YLIM =2)
plot_posterior(piecewisemodel)
parameters_credible_intervals(piecewisemodel)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.5, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = fit(data = asembo_chik,  model = piecewisemodel, chains=1, iter=5000)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
ggsave("asembo.chik.sero.png")
parameters_credible_intervals(piecewisemodel)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
#fit the model constant model
manyattapiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
print(manyattapiecewisemodel)
manyattapiecewisemodel = fit(data = manyatta_chik,  model = manyattapiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
ggsave("manyatta.chik.sero.png")
#kilifi
kilifidata<- Kilifidata_clean %>%
select(ageyrs,sex,age_cat,CHKpos, DENpos, RVFpos)
kilifidata$RVFpos <- ifelse(kilifidata$RVFpos == 1, TRUE, FALSE)
kilifidata$DENpos <- ifelse(kilifidata$DENpos == 1, TRUE, FALSE)
kilifidata$CHKpos <- ifelse(kilifidata$CHKpos == 1, TRUE, FALSE)
kilifidata$ageyrs=  as.integer(kilifidata$ageyrs)
kilifidata <- kilifidata %>%
mutate(ageyrs = ifelse(ageyrs == 0, 1, ageyrs))
kilifidata$sex<-as.character(kilifidata$sex)
kilifidata_chik <-SeroData(age_at_sampling = kilifidata$ageyrs,
Y= kilifidata$RVFpos,
sampling_year = 2022)
seroprevalence(kilifidata_chik)
seroprevalence.plot(kilifidata_chik, age_class = 5)
kilifidata_chik <-SeroData(age_at_sampling = kilifidata$ageyrs,
Y= kilifidata$CHKpos,
sampling_year = 2022)
seroprevalence(kilifidata_chik)
seroprevalence.plot(kilifidata_chik, age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=3, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.01, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=3, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
plot(kilifipiecewisemodel, YLIM =1)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'outbreak', priorC1 = 0.05, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
ggsave("kilifi.chik.sero.png")
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 0.2, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 0.1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2, priorC2 = 0.1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02, priorC2 = 0.1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 0.1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 0.1, seroreversion = 1, priorRho1 = 1, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 0.2, seroreversion = 1, priorRho1 = 1, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 1, seroreversion = 1, priorRho1 = 1, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
print(manyattapiecewisemodel)
print(piecewisemodel)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
plot_posterior(manyattapiecewisemodel)
135+350+400
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.006148107
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.5)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.01622000
getwd()
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.5, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
library(Rsero)
library(tidyverse)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.5, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = fit(data = asembo_chik,  model = piecewisemodel, chains=1, iter=5000)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
plot(piecewisemodel, YLIM =2)
plot_posterior(piecewisemodel)
parameters_credible_intervals(piecewisemodel)
1/2.291542e-02
#fit the model constant model
manyattapiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
print(manyattapiecewisemodel)
manyattapiecewisemodel = fit(data = manyatta_chik,  model = manyattapiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
plot_posterior(manyattapiecewisemodel)
traceplot_Rsero(manyattapiecewisemodel)
plot(manyattapiecewisemodel, YLIM =1)
parameters_credible_intervals(manyattapiecewisemodel)
1/0.01348712
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.002024465
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.00198118
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.01,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.001990308
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.01,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.2)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.1,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.2)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.1,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.1,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.3)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.3)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.4)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.01421325
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.2, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.4)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.4, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.4)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.01983307
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.5, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.4)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.6, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.4)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.2, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.3, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.5, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/ 0.002619142
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.4, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 0.4, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 0.4, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.001927187
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
plot(kilifipiecewisemodel, YLIM =1)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.06, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.001386764
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.06, priorRho2 = 0.2)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.02180437
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.06, priorRho2 = 0.3)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.01290804
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.06, priorRho2 = 0.5)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.006041159
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.5,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.06, priorRho2 = 0.5)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
