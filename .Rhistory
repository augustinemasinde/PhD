return(plots)
}
#Posterior distribution of relevant model parameters
parameters_credible_intervals(piecewise)
plot(asembopiecewise)
plot(asembopiecewise)
library(haven)
library(dplyr)
library(arsenal)
library(Rsero)
library(readxl)
library(rstan)
# Robust data loader: update data_dir to where your .dta files live (or use here::here("..."))
data_dir <- "/Users/augustinemasinde/Desktop/PhD files/Global Health"  # <- update if needed
data_files <- list(
Asembodata = file.path(data_dir, "Asembo PBIDS arbo.dta"),
Kilifidata = file.path(data_dir, "KHDSS arbo.dta"),
Kiberadata = file.path(data_dir, "Kibera PBIDS arbo.dta"),
manyattadata = file.path(data_dir, "Manyatta HDSS arbo.dta"),
NairobiUrbandata = file.path(data_dir, "NUHDSS arbo.dta")
)
#Asembo
asembodata<- Asembodata %>%
select(ageyrs,sex,age_cat,CHKpos, DENpos, RVFpos)
asembodata$RVFpos <- ifelse(asembodata$RVFpos == 1, TRUE, FALSE)
asembodata$DENpos <- ifelse(asembodata$DENpos == 1, TRUE, FALSE)
asembodata$CHKpos <- ifelse(asembodata$CHKpos == 1, TRUE, FALSE)
asembodata$ageyrs=  as.integer(asembodata$ageyrs)
asembodata <- asembodata %>%
mutate(ageyrs = ifelse(ageyrs == 0, 1, ageyrs))
asembodata$sex<-as.character(asembodata$sex)
asembo_chik <-SeroData(age_at_sampling = asembodata$ageyrs,
Y= asembodata$CHKpos,
sampling_year = 2022)
seroprevalence(asembo_chik)
seroprevalence.plot(asembo_chik, age_class = 5)
seroprevalence.plot(asembo_chik, age_class = 1)
seroprevalence.plot(asembo_chik, age_class = 5)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.3, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 5, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.3, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = fit(data = asembo_chik,  model = piecewisemodel, chains=1, iter=5000)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.2, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = fit(data = asembo_chik,  model = piecewisemodel, chains=1, iter=5000)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
plot(piecewisemodel, YLIM =1)
plot_posterior(piecewisemodel)
parameters_credible_intervals(piecewisemodel)
1/0.1534103
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.1, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = fit(data = asembo_chik,  model = piecewisemodel, chains=1, iter=5000)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
plot(piecewisemodel, YLIM =1)
plot_posterior(piecewisemodel)
parameters_credible_intervals(piecewisemodel)
1/0.1414365
#manyatta
manyattadata<- manyattadata_clean %>%
select(ageyrs,sex,age_cat,CHKpos, DENpos, RVFpos)
manyattadata$RVFpos <- ifelse(manyattadata$RVFpos == 1, TRUE, FALSE)
manyattadata$DENpos <- ifelse(manyattadata$DENpos == 1, TRUE, FALSE)
manyattadata$CHKpos <- ifelse(manyattadata$CHKpos == 1, TRUE, FALSE)
manyattadata$ageyrs=  as.integer(manyattadata$ageyrs)
manyattadata <- manyattadata %>%
mutate(ageyrs = ifelse(ageyrs == 0, 1, ageyrs))
manyattadata$sex<-as.character(manyattadata$sex)
manyatta_chik <-SeroData(age_at_sampling = manyattadata$ageyrs,
Y= manyattadata$CHKpos,
sampling_year = 2022)
seroprevalence(manyatta_chik)
seroprevalence.plot(manyatta_chik, age_class = 5)
#fit the model constant model
manyattapiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
print(manyattapiecewisemodel)
manyattapiecewisemodel = fit(data = manyatta_chik,  model = manyattapiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
plot_posterior(manyattapiecewisemodel)
traceplot_Rsero(manyattapiecewisemodel)
plot(manyattapiecewisemodel, YLIM =1)
parameters_credible_intervals(manyattapiecewisemodel)
1/0.03014285
#fit the model constant model
manyattapiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.01, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
print(manyattapiecewisemodel)
manyattapiecewisemodel = fit(data = manyatta_chik,  model = manyattapiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
plot_posterior(manyattapiecewisemodel)
traceplot_Rsero(manyattapiecewisemodel)
plot(manyattapiecewisemodel, YLIM =1)
parameters_credible_intervals(manyattapiecewisemodel)
1/0.02952756
#fit the model constant model
manyattapiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
print(manyattapiecewisemodel)
manyattapiecewisemodel = fit(data = manyatta_chik,  model = manyattapiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
plot_posterior(manyattapiecewisemodel)
traceplot_Rsero(manyattapiecewisemodel)
plot(manyattapiecewisemodel, YLIM =1)
parameters_credible_intervals(manyattapiecewisemodel)
#kilifi
kilifidata<- Kilifidata_clean %>%
select(ageyrs,sex,age_cat,CHKpos, DENpos, RVFpos)
kilifidata$RVFpos <- ifelse(kilifidata$RVFpos == 1, TRUE, FALSE)
kilifidata$DENpos <- ifelse(kilifidata$DENpos == 1, TRUE, FALSE)
kilifidata$CHKpos <- ifelse(kilifidata$CHKpos == 1, TRUE, FALSE)
kilifidata$ageyrs=  as.integer(kilifidata$ageyrs)
kilifidata <- kilifidata %>%
mutate(ageyrs = ifelse(ageyrs == 0, 1, ageyrs))
kilifidata$sex<-as.character(kilifidata$sex)
kilifidata_chik <-SeroData(age_at_sampling = kilifidata$ageyrs,
Y= kilifidata$RVFpos,
sampling_year = 2022)
seroprevalence(kilifidata_chik)
seroprevalence.plot(kilifidata_chik, age_class = 5)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.4, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.2, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = fit(data = asembo_chik,  model = piecewisemodel, chains=1, iter=5000)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
plot(piecewisemodel, YLIM =1)
plot(piecewisemodel, YLIM =2)
plot_posterior(piecewisemodel)
parameters_credible_intervals(piecewisemodel)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
ggsave("asembo.chik.sero.png")
plot(piecewisemodel, YLIM =2)
plot_posterior(piecewisemodel)
parameters_credible_intervals(piecewisemodel)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.5, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = fit(data = asembo_chik,  model = piecewisemodel, chains=1, iter=5000)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
ggsave("asembo.chik.sero.png")
parameters_credible_intervals(piecewisemodel)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
#fit the model constant model
manyattapiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
print(manyattapiecewisemodel)
manyattapiecewisemodel = fit(data = manyatta_chik,  model = manyattapiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
ggsave("manyatta.chik.sero.png")
#kilifi
kilifidata<- Kilifidata_clean %>%
select(ageyrs,sex,age_cat,CHKpos, DENpos, RVFpos)
kilifidata$RVFpos <- ifelse(kilifidata$RVFpos == 1, TRUE, FALSE)
kilifidata$DENpos <- ifelse(kilifidata$DENpos == 1, TRUE, FALSE)
kilifidata$CHKpos <- ifelse(kilifidata$CHKpos == 1, TRUE, FALSE)
kilifidata$ageyrs=  as.integer(kilifidata$ageyrs)
kilifidata <- kilifidata %>%
mutate(ageyrs = ifelse(ageyrs == 0, 1, ageyrs))
kilifidata$sex<-as.character(kilifidata$sex)
kilifidata_chik <-SeroData(age_at_sampling = kilifidata$ageyrs,
Y= kilifidata$RVFpos,
sampling_year = 2022)
seroprevalence(kilifidata_chik)
seroprevalence.plot(kilifidata_chik, age_class = 5)
kilifidata_chik <-SeroData(age_at_sampling = kilifidata$ageyrs,
Y= kilifidata$CHKpos,
sampling_year = 2022)
seroprevalence(kilifidata_chik)
seroprevalence.plot(kilifidata_chik, age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=3, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.01, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=3, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
plot(kilifipiecewisemodel, YLIM =1)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'outbreak', priorC1 = 0.05, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
ggsave("kilifi.chik.sero.png")
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 0.2, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 0.1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2, priorC2 = 0.1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02, priorC2 = 0.1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 0.1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 0.1, seroreversion = 1, priorRho1 = 1, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 0.2, seroreversion = 1, priorRho1 = 1, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05, priorC2 = 1, seroreversion = 1, priorRho1 = 1, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
print(manyattapiecewisemodel)
print(piecewisemodel)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
plot_posterior(manyattapiecewisemodel)
135+350+400
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.006148107
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.5)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.01622000
getwd()
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.5, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
library(Rsero)
library(tidyverse)
piecewisemodel = FOImodel(type = 'outbreak', prioralpha1 = 0.5, prioralpha2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1, K=1, priorT1 = 10, priorT2 = 10)
print(piecewisemodel)
piecewisemodel = fit(data = asembo_chik,  model = piecewisemodel, chains=1, iter=5000)
seroprevalence.fit(piecewisemodel, YLIM = 1, age_class = 5)
plot(piecewisemodel, YLIM =2)
plot_posterior(piecewisemodel)
parameters_credible_intervals(piecewisemodel)
1/2.291542e-02
#fit the model constant model
manyattapiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02, priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
print(manyattapiecewisemodel)
manyattapiecewisemodel = fit(data = manyatta_chik,  model = manyattapiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(manyattapiecewisemodel, YLIM=1, age_class = 5)
plot_posterior(manyattapiecewisemodel)
traceplot_Rsero(manyattapiecewisemodel)
plot(manyattapiecewisemodel, YLIM =1)
parameters_credible_intervals(manyattapiecewisemodel)
1/0.01348712
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.002024465
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.00198118
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.01,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.001990308
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.01,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.2)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.1,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.2)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.1,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.1,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.3)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.3)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.4)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.01421325
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.2, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.4)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.4, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.4)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.01983307
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.5, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.4)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.6, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 0.4)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.2, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.3, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.5, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/ 0.002619142
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.2,  priorC2 = 0.4, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 0.4, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 0.4, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.001927187
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.2, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
plot(kilifipiecewisemodel, YLIM =1)
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.06, priorRho2 = 1)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.001386764
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.02,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.06, priorRho2 = 0.2)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.02180437
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.06, priorRho2 = 0.3)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.01290804
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.05,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.06, priorRho2 = 0.5)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
1/0.006041159
#fit the model constant model
kilifipiecewisemodel = FOImodel(type = 'constant', priorC1 = 0.5,  priorC2 = 1, seroreversion = 1, priorRho1 = 0.06, priorRho2 = 0.5)
kilifipiecewisemodel = fit(data = kilifidata_chik,  model = kilifipiecewisemodel, chains=1, iter=5000)
seroprevalence.fit(kilifipiecewisemodel,age_class = 5)
#Posterior distribution of relevant model parameters
parameters_credible_intervals(kilifipiecewisemodel)
nairobi_data <-Nairobi_clean %>%
mutate(agecat = case_when(
ageyrs >= 0 & ageyrs < 5 ~ "<5",
ageyrs >= 5 & ageyrs <15 ~ "5-14",
ageyrs >= 15 & ageyrs <45 ~ "15-44",
ageyrs >= 45 & ageyrs <65 ~ "45-64",
ageyrs >= 65 ~ "65+",
TRUE ~ NA_character_
))
library(tidyverse)
nairobi_data <-Nairobi_clean %>%
mutate(agecat = case_when(
ageyrs >= 0 & ageyrs < 5 ~ "<5",
ageyrs >= 5 & ageyrs <15 ~ "5-14",
ageyrs >= 15 & ageyrs <45 ~ "15-44",
ageyrs >= 45 & ageyrs <65 ~ "45-64",
ageyrs >= 65 ~ "65+",
TRUE ~ NA_character_
))
nairobi_data <- nairobi_data %>%
mutate(agecat = factor(agecat, levels = c("<5", "5-14", "15-44", "45-64", "65+"))) %>%
arrange(agecat)
view(nairobi_data)
tapply(nairobi_data$CHKpos, nairobi_data$agecat, sum, na.rm = TRUE)
asembo_data <-Asembodata %>%
mutate(agecat = case_when(
ageyrs >= 0 & ageyrs < 5 ~ "<5",
ageyrs >= 5 & ageyrs <15 ~ "5-14",
ageyrs >= 15 & ageyrs <45 ~ "15-44",
ageyrs >= 45 & ageyrs <65 ~ "45-64",
ageyrs >= 65 ~ "65+",
TRUE ~ NA_character_
))
asembo_data<- asembo_data %>% select(agecat, sex, CHKpos,DENpos,RVFpos)
tapply(asembo_data$CHKpos, asembo_data$agecat, sum, na.rm = TRUE)
tapply(asembo_data$CHKpos, asembo_data$agecat, sum, na.rm = TRUE)
tapply(asembo_data$CHKpos, asembo_data$sex, sum, na.rm = TRUE)
tapply(asembo_data$DENpos, asembo_data$sex, sum, na.rm = TRUE)
tapply(asembo_data$DENpos, asembo_data$agecat, sum, na.rm = TRUE)
tapply(asembo_data$RVFpos, asembo_data$sex, sum, na.rm = TRUE)
tapply(asembo_data$RVFpos, asembo_data$agecat, sum, na.rm = TRUE)
asembo_set <- asembo_set %>%
mutate(agecat = factor(agecat, levels = c("<5", "5-14", "15-44", "45-64", "65+"))) %>%
arrange(agecat)
tapply(asembo_set$RVFpos, asembo_data$sex, sum, na.rm = TRUE)
view(asembo_set)
tapply(asembo_set$pop, asembo_data$sex, sum, na.rm = TRUE)
tapply(asembo_set$pop, asembo_set$sex, sum, na.rm = TRUE)
tapply(asembo_set$pop, asembo_set$agecat, sum, na.rm = TRUE)
sum(asembo_set$pop)
view(manyatta_data)
tapply(manyatta_data$CHKpos, manyatta_data$agecat, sum, na.rm = TRUE)
sum(manyatta_data$CHKpos)
tapply(manyatta_data$CHKpos, manyatta_data$sex, sum, na.rm = TRUE)
view(manyatta_set)
tapply(manyatta_set$pop, manyatta_set$sex, sum, na.rm = TRUE)
tapply(manyatta_set$pop, manyatta_set$agecat, sum, na.rm = TRUE)
sum(manyatta_set$pop)
tapply(manyatta_data$DENpos, manyatta_data$sex, sum, na.rm = TRUE)
tapply(manyatta_data$DENpos, manyatta_data$agecat, sum, na.rm = TRUE)
tapply(manyatta_data$RVFpos, manyatta_data$sex, sum, na.rm = TRUE)
tapply(manyatta_data$RVFpos, manyatta_data$agecat, sum, na.rm = TRUE)
tapply(kibera_data$CHKpos, kibera_data$agecat, sum, na.rm = TRUE)
kibera_data <-Kiberadata %>%
mutate(agecat = case_when(
ageyrs >= 0 & ageyrs < 5 ~ "<5",
ageyrs >= 5 & ageyrs <15 ~ "5-14",
ageyrs >= 15 & ageyrs <45 ~ "15-44",
ageyrs >= 45 & ageyrs <65 ~ "45-64",
ageyrs >= 65 ~ "65+",
TRUE ~ NA_character_
))
kibera_data<- kibera_data %>% select(agecat, sex, chke1_pos,denv_pos,rvfgc_pos)
kibera_data <- kibera_data %>%
mutate(agecat = factor(agecat, levels = c("<5", "5-14", "15-44", "45-64", "65+"))) %>%
arrange(agecat)
tapply(kibera_data$CHKpos, kibera_data$agecat, sum, na.rm = TRUE)
view(kibera_data)
tapply(kibera_data$chke1_pos, kibera_data$agecat, sum, na.rm = TRUE)
tapply(kibera_data$chke1_pos, kibera_data$sex, sum, na.rm = TRUE)
147+94
#Kibera
kibera_set <- kibera_pop_data %>% select(age_group,Sex, N_mid2022)
kibera_set <- kibera_set %>% rename(agecat = age_group,sex = Sex, pop = N_mid2022)
kibera_set$pop<- as.numeric(kibera_set$pop)
kibera_set <- kibera_set %>%
mutate(sex = recode(sex,
"Female" = "F",
"Male"   = "M"))
kibera_set<-kibera_set %>% mutate(pw = pop/sum(pop)) %>% select(agecat, sex, pop, pw)
kibera_set <- kibera_set %>%
mutate(agecat = factor(agecat, levels = c("<5", "5-14", "15-44", "45-64", "65+"))) %>%
arrange(agecat)
tapply(kibera_set$, kibera_set$sex, sum, na.rm = TRUE)
tapply(kibera_set$pop, kibera_set$sex, sum, na.rm = TRUE)
tapply(kibera_set$pop, kibera_set$agecat, sum, na.rm = TRUE)
